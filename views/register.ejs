<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="/main.css" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <%- include('nav.ejs', { user: user }) %>
    <div class="form-center">
      <form class="auth-form" action="/register" method="POST">
        <h4>회원가입</h4>

        <div class="mb-3">
          <label for="email" class="form-label">
            이메일 <span class="required">*</span>
          </label>
          <input
            name="useremail"
            type="email"
            class="form-control"
            id="email"
            aria-describedby="emailHelp"
            required
          />
        </div>

        <div class="mb-3">
          <label for="password" class="form-label">
            비밀번호 <span class="required">*</span>
          </label>
          <input
            name="password"
            type="password"
            class="form-control"
            id="password"
            required
          />
        </div>

        <div class="mb-3">
          <label for="confirm_password" class="form-label">
            비밀번호 확인 <span class="required">*</span>
          </label>
          <input
            name="confirm_password"
            type="password"
            class="form-control"
            id="confirm_password"
            required
          />
        </div>

        <div class="mb-3">
          <label for="name" class="form-label">
            이름 <span class="required">*</span>
          </label>
          <input
            name="username"
            type="text"
            class="form-control"
            id="name"
            required
          />
        </div>

        <div class="mb-3">
          <label for="nickname" class="form-label">
            닉네임 <span class="required">*</span>
          </label>
          <input
            name="nickname"
            type="text"
            class="form-control"
            id="nickname"
            required
          />
        </div>

        <div class="auth-form-footer">
          <button type="submit" class="btn btn-primary">회원가입</button>
        </div>
      </form>
    </div>
    <script>
      // 회원가입 form 유효성 검사
      document
        .querySelectorAll(".login-form input[required]")
        .forEach((input) => {
          input.addEventListener("input", function () {
            // 가장 가까운 .mb-3 부모 요소 내의 label 안에 있는 span.required 요소를 찾음
            const span = this.closest(".mb-3").querySelector("label .required");
            console.log(span);
            if (this.checkValidity()) {
              span.classList.add("valid"); // 입력이 유효하면 초록색으로 변경
            } else {
              span.classList.remove("valid"); // 입력이 유효하지 않으면 다시 빨간색
            }
          });
        });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
